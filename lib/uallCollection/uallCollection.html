<html>
<head>
<title>Source file exported to file</title>
</head>
<!-- Generated by SynEdit HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  size=3 face="Courier New"><font color="#000080">// uallDisasm.pas

    { read an assembler instruction on a specific address
      [p]             pointer to address of assembler instruction
      [name]          returns a string with name of the assembler instruction
      [size]          returns the size of the assembler instruction
      [result]        true if successful, false if [p] not readable or unknown assembler instruction}
  </font><font color="#800000">function </font>InstructionInfo(p: pointer; <font color="#800000">var name</font>: <font color="#800000">string</font>; <font color="#800000">var </font>size: integer): boolean; <font color="#800000">stdcall</font>;



<font color="#000080">// uallHook.pas

    { hooks a function in memory
      [oldfunction]   address of function to hook
      [yourfunction]  address of the callback function
      [nextfunction]  address of function which must be used instead of [oldfunction] (else endless loop)
      [result]        true if successful hooked else false}
  </font><font color="#800000">function </font>HookCode(oldfunction, yourfunction: pointer; <font color="#800000">var </font>nextfunction: pointer): boolean; <font color="#800000">stdcall</font>;

    <font color="#000080">{ unhooks a function which is hooked by HookCode
      [nextfunction]  address of function which was returned by HookCode
      [result]        true if successful unhooked elese false}
  </font><font color="#800000">function </font>UnhookCode(<font color="#800000">var </font>nextfunction: pointer): boolean; <font color="#800000">stdcall</font>;

    <font color="#000080">{ hooks an imported API function from a module
      [modulehandle]  handle of module which imports the function (NOT exports)
      [oldfunction]   address of function which is imported
      [yourfunction]  address of callback function
      [result]        true if successfull hooked else false}
  </font><font color="#800000">function </font>HookApiIAT(modulehandle: integer; oldfunction, yourfunction: pointer): boolean; <font color="#800000">stdcall</font>; <font color="#800000">overload</font>;

    <font color="#000080">{ hooks an improted API modulewide
      [modulehandle]  handle of module which imports the function (NOT exports)
      [oldfunction]   address of function which is imported
      [yourfunction]  address of callback function
      [result]        true if successfull hooked else false}
  </font><font color="#800000">function </font>HookApiIAT(oldfunction, yourfunction: pointer): boolean; <font color="#800000">stdcall</font>; <font color="#800000">overload</font>;

    <font color="#000080">{ injects the executable into a target process
      [pid]           target process
      [dllmain]       address of dllmain inside the executable which is called after injection
      [result]        true if successful injected into target process}
  </font><font color="#800000">function </font>InjectMe(pid: integer; dllmain: pointer): boolean; <font color="#800000">stdcall</font>;

    <font color="#000080">{ injects a library into a target process
      [pid]           target process
      [dlln]          path to dll which should be injected
      [result]        address of inject code inside targetprocess else nil}
  </font><font color="#800000">function </font>InjectLibrary(pid: cardinal; dlln: pchar): pointer; <font color="#800000">stdcall</font>;

    <font color="#000080">{ uninjects a library into a target process
      [pid]           target process
      [dlln]          path to dll which should be uninjected
      [result]        address of uninject code inside targetprocess else nil}
  </font><font color="#800000">function </font>UnloadLibrary(pid: cardinal; dlln: pchar): pointer; <font color="#800000">stdcall</font>;

    <font color="#000080">{ injects a library into all current processes
      [libname]       path to dll which should be injected
      [result]        count of process which has loaded the dll}
  </font><font color="#800000">function </font>GlobalInjectLibrary(libname: pchar): integer; <font color="#800000">stdcall</font>;

    <font color="#000080">{ uninjects a library into all current processes
      [libname]       path to dll which should be uninjected
      [result]        count of process which has unloaded the dll}
  </font><font color="#800000">function </font>GlobalUnloadLibrary(libname: pchar): integer; <font color="#800000">stdcall</font>;



<font color="#000080">// uallKernel.pas

    { loads a library into the process
      [dllname]       name of dll which should be loaded
      [result]        handle of dll if successful else 0}
  </font><font color="#800000">function </font>LoadLibraryX(dllname: pchar): integer; <font color="#800000">stdcall</font>; <font color="#800000">overload</font>;
  
    <font color="#000080">{ loads a library into the process
      [dllname]       name of dll which should be loaded
      [name]          you can pass everything here
                      it uses the third param of dllmain
      [result]        handle of dll if successful else 0}
  </font><font color="#800000">function </font>LoadLibraryX(dllname, <font color="#800000">name</font>: pchar): integer; <font color="#800000">stdcall</font>; <font color="#800000">overload</font>;

    <font color="#000080">{ creates a thread into the target process (win9x support)
      [pid]           target process
      [p]             startaddress of thread
      [result]        true if successful started else 0}
  </font><font color="#800000">function </font>CreateRemoteThreadX(pid: cardinal; p: pointer): boolean; <font color="#800000">stdcall</font>;

    <font color="#000080">{ open a thread with access right (win9x support)
      [access]        access rights
      [inherited handle]
      [tid]           thread id to open
      [result]        handle with access rights if successful else 0}
  </font><font color="#800000">function </font>OpenThreadX(access: integer; inherithandle: boolean; tid: integer): integer; <font color="#800000">stdcall</font>;
  
    <font color="#000080">{ allocates memory in the target process (win9x support, EXECUTE_READWRITE)
      [pid]           process id
      [size]          size of memory which should be allocated
      [result]        address of allocated memory if successful else nil}
  </font><font color="#800000">function </font>VirtualAllocExX(pid: cardinal; Size: cardinal): pointer; <font color="#800000">stdcall</font>;

    <font color="#000080">{ get the entrypoint of a function in dll
      [modulehandle]  handle of module which exports the function
      [procname]      name of exported function
      [result]        address of the function if successful else nil}
  </font><font color="#800000">function </font>GetProcAddressX(module: integer; procname: pchar): pointer; <font color="#800000">stdcall</font>;

    <font color="#000080">{ frees memory which is allocated by VirtualAllocEx in a process
      [pid]           process id
      [memaddr]       address of memory which should be freed
      [size]          size of memory to free
      [result]        true if successful else false}
  </font><font color="#800000">function </font>VirtualFreeExX(pid: cardinal; Memaddr: pointer; Size: cardinal): boolean; <font color="#800000">stdcall</font>;

    <font color="#000080">{ returns handle of kernel32.dll module
      [result]        handle of kernel32.dll module}
  </font><font color="#800000">function </font>GetKernelHandle: integer; <font color="#800000">stdcall</font>;
  
    <font color="#000080">{ return handle of the calling module
      [result]        handle of the calling module}
  </font><font color="#800000">function </font>GetOwnModuleHandle: cardinal; <font color="#800000">stdcall</font>;
  
    <font color="#000080">{ returns handle of module which where the address points to
      [addr]          address inside a module
      [result]        handle of module if successful else 0}
  </font><font color="#800000">function </font>GetRealModuleHandle(addr: pointer): cardinal <font color="#800000">stdcall</font>;



<font color="#000080">// uallProcess.pas

    { returns processid of a processname
      [exenames]      list of processname ex. 'hl.exe'#13#10'cstrike.exe'#13#10
                      use #13#10 as seperator
      [result]        processid if successful else 0}
  </font><font color="#800000">function </font>FindProcess(ExeNames: <font color="#800000">string</font>): integer; <font color="#800000">stdcall</font>;

    <font color="#000080">{ lists modules of a process
      [pid]           process id
      [result]        string with modules (seperated with #13#10) if successful else empty string}
  </font><font color="#800000">function </font>FindModulesInProcess(pid: cardinal): <font color="#800000">string</font>; <font color="#800000">stdcall</font>; <font color="#800000">overload</font>;
  
    <font color="#000080">{ lists modules of a process
      [processname]   name of process
      [result]        string with modules (seperated with #13#10) if successful else empty string}
  </font><font color="#800000">function </font>FindModulesInProcess(processname: <font color="#800000">string</font>): <font color="#800000">string</font>; <font color="#800000">stdcall</font>; <font color="#800000">overload</font>;

    <font color="#000080">{ list of all processes
      [result]       string with all processnames (seperated with #13#10) if successful else empty string}
  </font><font color="#800000">function </font>FindAllProcesses: <font color="#800000">string</font>; <font color="#800000">stdcall</font>;

    <font color="#000080">{ find a thread from a process id
      [pid]          process id
      [result]       a threadid from the process if successful else 0
    }
  </font><font color="#800000">function </font>GetThread(pid: integer): integer; <font color="#800000">stdcall</font>;



<font color="#000080">// uallProtect.pas

    { hides a library in the process (GetModuleHandle will fail)
      [lib]          handle of library
      [result]       true if successful else false}
  </font><font color="#800000">function </font>HideLibraryNT(lib: integer): boolean; <font color="#800000">stdcall</font>;
  
    <font color="#000080">{ unhides a library which was hidden by HideLibraryNT
      [lib]          handle of library
      [result]       true if successful else false}
  </font><font color="#800000">function </font>ShowLibraryNT(lib: integer): boolean; <font color="#800000">stdcall</font>;

    <font color="#000080">{ returns if a debugger is attached
      [result]       true if debugger detected else false}
  </font><font color="#800000">function </font>IsDebuggerPresent: boolean; <font color="#800000">stdcall</font>;
  
    <font color="#000080">{ gives the calling process the debug privilege
      [result]       true if successful else false}
  </font><font color="#800000">function </font>GetDebugPrivilege: boolean; <font color="#800000">stdcall</font>;

    <font color="#000080">{ forces the process to load a library (you can have some instances of one library)
      [libname]      name of module
      [result]       handle of module}
  </font><font color="#800000">function </font>ForceLoadLibrary(libname: pchar): integer; <font color="#800000">stdcall</font>;

    <font color="#000080">{ calls a function, debuggers will crash
      [proc]         address of function which should be called}
  </font><font color="#800000">procedure </font>ProtectCall(proc: pointer); <font color="#800000">stdcall</font>;
  
    <font color="#000080">{ if this function is called windows debggers cant attach the process anymore}
  </font><font color="#800000">procedure </font>AntiDebugActiveProcess; <font color="#800000">stdcall</font>;
  
    <font color="#000080">{ checks if a API is hooked by CodeOverwriting/Import/Export table hook
      [dllname]      name of dll which exports the function
      [procname]     name of exported API
      [result]       true if function is hooked else false}
  </font><font color="#800000">function </font>IsHooked(dllname, procname: pchar): boolean; <font color="#800000">stdcall</font>;

    <font color="#000080">{ returns handle of kernel32.dll module
      [result]       handle of kernel32.dll module}
  </font><font color="#800000">function </font>GetKernelHandle: integer; <font color="#800000">stdcall</font>;



<font color="#000080">// uallRelocHook.pas

    { hooks an API by the reclocation table (own method)
      [oldaddress]   address of API
      [newaddress]   address of callback function
      [nextaddress]  address of function which should be used after hooking (endless loop otherwise)
      [result]       count of installed hooks}
  </font><font color="#800000">function </font>HookRelocationTable(oldaddress, newaddress: pointer; <font color="#800000">var </font>nextaddress: pointer): integer; <font color="#800000">stdcall</font>;
  
    <font color="#000080">{ unhook an API which  was hooked by the relocation table
      [nextaddress]  callback address
      [newaddress]   original API address
      [result]       count of uninstalled hooks}
  </font><font color="#800000">function </font>UnHookRelocationTable(nextaddress, newaddress: pointer): integer; <font color="#800000">stdcall</font>;



<font color="#000080">// uallTableHook.pas
    { returns assembler intruction length
      [addr]         address of assembler instruction
      [result]       size of instruction}
  </font><font color="#800000">function </font>myInstructionLength(addr: pointer): integer; <font color="#800000">stdcall</font>;

    <font color="#000080">{ hooks an API / code by code overwriting (JMP)
      [oldfunction]  address of API / code
      [yourfunction] address of callback function
      [nextfucntion] address of function which should be used after hooking (endless loop otherwise)
      [result]       true if successful hooked else false}
  </font><font color="#800000">function </font>HookAPIJMP(oldfunction,yourfunction: pointer; <font color="#800000">var </font>nextfunction: pointer): boolean; <font color="#800000">stdcall</font>;

    <font color="#000080">{ unhooks an API /code which was hooked by code overwriting (jmp)
      [nextfunction] address of function which was returned by HookAPIJMP
      [result]       true if successfuk unhooked else false}
  </font><font color="#800000">function </font>UnhookAPIJMP(nextfunction: pointer): boolean; <font color="#800000">stdcall</font>;



<font color="#000080">// uallUtil.pas

    { extracts a filename with its extention
      [s]            file
      [result]       filename with extention}
  </font><font color="#800000">function </font>ExtractFileNameWithExtention(s: <font color="#800000">string</font>): <font color="#800000">string</font>; <font color="#800000">stdcall</font>;

    <font color="#000080">{ extracts a filename without extention
      [s]            file
      [result]       filename without extention}
  </font><font color="#800000">function </font>ExtractFileName(s: <font color="#800000">string</font>): <font color="#800000">string</font>; <font color="#800000">stdcall</font>;
  
    <font color="#000080">{ retuns the uppercase of the string
      [s]            string
      [result]       uppercase of string}
  </font><font color="#800000">function </font>UpperCase(s: <font color="#800000">string</font>): <font color="#800000">string</font>; <font color="#800000">stdcall</font>;

    <font color="#000080">{ retuns the lowercase of the string
      [s]            string
      [result]       lowercase of string}
  </font><font color="#800000">function </font>LowerCase(s: <font color="#800000">string</font>): <font color="#800000">string</font>; <font color="#800000">stdcall</font>;

    <font color="#000080">{ returns the path of a file
      [s]            file
      [result]       paht of file}
  </font><font color="#800000">function </font>ExtractFilePath(s: <font color="#800000">String</font>): <font color="#800000">string</font>; <font color="#800000">stdcall</font>;

    <font color="#000080">{ returns an integer value as string
      [value]        integer value
      [result]       [value] as string}
  </font><font color="#800000">function </font>IntToStr(Value: integer): <font color="#800000">string</font>; <font color="#800000">stdcall</font>;
  
    <font color="#000080">{ returns an integer value as hexstring
      [value]        integer value
      [digits]       count of digits which the string should return
      [result]       [value] as hexstring}
  </font><font color="#800000">function </font>IntToHex(Value, Digits: integer): <font color="#800000">string</font>; <font color="#800000">stdcall</font>;
  
    <font color="#000080">{ return the directory of the executable
      [result]       directory of the executable}
  </font><font color="#800000">function </font>GetExeDirectory: <font color="#800000">string</font>; <font color="#800000">stdcall</font>;

    <font color="#000080">{ returns if system is windows NT based
      [result] true if system is NT based else false}
  </font><font color="#800000">function </font>isNT: boolean; <font color="#800000">stdcall</font>;

    <font color="#000080">{ returns if system is windows 9x based
      [result] true if system is 9x (95 / 98 / 98 SE / ME) based else false}
  </font><font color="#800000">function </font>is9x: boolean; <font color="#800000">stdcall</font>;
</font>
</code></pre>
</body>
</html>